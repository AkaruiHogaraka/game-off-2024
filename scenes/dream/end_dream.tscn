[gd_scene load_steps=47 format=4 uid="uid://c5lh836uk0pjq"]

[ext_resource type="Script" path="res://scripts/scene.gd" id="1_l0luh"]
[ext_resource type="Resource" uid="uid://bbuimr2ci8b2u" path="res://resources/mask/depth_3.tres" id="2_irmlu"]
[ext_resource type="Script" path="res://scripts/scene_connection.gd" id="3_erpmw"]
[ext_resource type="PackedScene" uid="uid://c0xj0bpy4qsax" path="res://prefabs/misc/end_trigger.tscn" id="4_epejp"]
[ext_resource type="TileSet" uid="uid://p6g573vayl4o" path="res://tileset/game_tileset.tres" id="5_j0nxd"]
[ext_resource type="PackedScene" uid="uid://cuguybm5sutw1" path="res://prefabs/level_objects/camera.tscn" id="6_5ywwy"]
[ext_resource type="PackedScene" uid="uid://cmg5x4vwwctan" path="res://prefabs/level_objects/door.tscn" id="7_4di10"]
[ext_resource type="Script" path="res://scripts/dialogue_interaction.gd" id="8_13h1s"]
[ext_resource type="Texture2D" uid="uid://cdrq636sukls2" path="res://sprites/player_spritesheet.png" id="8_sbf1w"]
[ext_resource type="Script" path="res://scripts/dialogue_writer.gd" id="9_rdfn1"]
[ext_resource type="FontFile" uid="uid://bbp8fqpdwwrye" path="res://fonts/04B_03__.TTF" id="10_ywiws"]
[ext_resource type="Texture2D" uid="uid://dfvoiojl3kjdf" path="res://sprites/nine-rect.png" id="11_s0apf"]
[ext_resource type="Texture2D" uid="uid://k4wb8qddqycn" path="res://sprites/z_continue.png" id="12_u2y6j"]
[ext_resource type="PackedScene" uid="uid://ckey3awf3arh8" path="res://audio/prefabs/speak.tscn" id="14_yfxiy"]

[sub_resource type="AtlasTexture" id="AtlasTexture_7leli"]
atlas = ExtResource("8_sbf1w")
region = Rect2(0, 96, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_ea48i"]
atlas = ExtResource("8_sbf1w")
region = Rect2(32, 96, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_2jlkl"]
atlas = ExtResource("8_sbf1w")
region = Rect2(64, 96, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_vslhc"]
atlas = ExtResource("8_sbf1w")
region = Rect2(0, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_wdn5q"]
atlas = ExtResource("8_sbf1w")
region = Rect2(32, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_tordn"]
atlas = ExtResource("8_sbf1w")
region = Rect2(64, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_b3u41"]
atlas = ExtResource("8_sbf1w")
region = Rect2(96, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_8xgw2"]
atlas = ExtResource("8_sbf1w")
region = Rect2(128, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_jwmsa"]
atlas = ExtResource("8_sbf1w")
region = Rect2(96, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_jlkq5"]
atlas = ExtResource("8_sbf1w")
region = Rect2(64, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_vymdj"]
atlas = ExtResource("8_sbf1w")
region = Rect2(32, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_r1oai"]
atlas = ExtResource("8_sbf1w")
region = Rect2(0, 64, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_ysdm5"]
atlas = ExtResource("8_sbf1w")
region = Rect2(0, 128, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_lc2p3"]
atlas = ExtResource("8_sbf1w")
region = Rect2(0, 160, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_3ukgp"]
atlas = ExtResource("8_sbf1w")
region = Rect2(32, 160, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_5ta2x"]
atlas = ExtResource("8_sbf1w")
region = Rect2(64, 160, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_0e5ud"]
atlas = ExtResource("8_sbf1w")
region = Rect2(96, 160, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_s6lip"]
atlas = ExtResource("8_sbf1w")
region = Rect2(128, 160, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_ysg2e"]
atlas = ExtResource("8_sbf1w")
region = Rect2(160, 160, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_gw04h"]
atlas = ExtResource("8_sbf1w")
region = Rect2(192, 160, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_l4o3h"]
atlas = ExtResource("8_sbf1w")
region = Rect2(0, 32, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_aaaie"]
atlas = ExtResource("8_sbf1w")
region = Rect2(32, 32, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_qnedj"]
atlas = ExtResource("8_sbf1w")
region = Rect2(64, 32, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_vqa38"]
atlas = ExtResource("8_sbf1w")
region = Rect2(96, 32, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_e7gqe"]
atlas = ExtResource("8_sbf1w")
region = Rect2(128, 32, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_aiuxc"]
atlas = ExtResource("8_sbf1w")
region = Rect2(160, 32, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_xj63o"]
atlas = ExtResource("8_sbf1w")
region = Rect2(192, 32, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_i0byo"]
atlas = ExtResource("8_sbf1w")
region = Rect2(224, 32, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_fafo8"]
atlas = ExtResource("8_sbf1w")
region = Rect2(256, 32, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_5bugj"]
atlas = ExtResource("8_sbf1w")
region = Rect2(288, 32, 32, 32)

[sub_resource type="SpriteFrames" id="SpriteFrames_kh50a"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_7leli")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_ea48i")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_2jlkl")
}],
"loop": false,
"name": &"fall",
"speed": 15.0
}, {
"frames": [{
"duration": 2.0,
"texture": SubResource("AtlasTexture_vslhc")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_wdn5q")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_tordn")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_b3u41")
}, {
"duration": 2.0,
"texture": SubResource("AtlasTexture_8xgw2")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_jwmsa")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_jlkq5")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_vymdj")
}],
"loop": true,
"name": &"idle",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_r1oai")
}],
"loop": false,
"name": &"jump",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_ysdm5")
}],
"loop": true,
"name": &"sleep",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_lc2p3")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_3ukgp")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_5ta2x")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_0e5ud")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_s6lip")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_ysg2e")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_gw04h")
}],
"loop": false,
"name": &"wake_up",
"speed": 12.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_l4o3h")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_aaaie")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_qnedj")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_vqa38")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_e7gqe")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_aiuxc")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_xj63o")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_i0byo")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_fafo8")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_5bugj")
}],
"loop": true,
"name": &"walk",
"speed": 12.0
}]

[sub_resource type="AtlasTexture" id="AtlasTexture_eyybe"]
atlas = ExtResource("12_u2y6j")
region = Rect2(3, 3, 10, 10)

[node name="EndDream" type="Node2D" node_paths=PackedStringArray("scene_camera", "alternate_scene")]
use_parent_material = true
script = ExtResource("1_l0luh")
scene_camera = NodePath("Camera")
alternate_scene = NodePath("AltConnection")
mask_settings = ExtResource("2_irmlu")

[node name="AltConnection" type="Node" parent="."]
script = ExtResource("3_erpmw")
scene_path = "res://scenes/reality/end_reality.tscn"

[node name="Floor" type="TileMapLayer" parent="."]
use_parent_material = true
tile_map_data = PackedByteArray("AAAAAAIAAgAAAAAAAQABAAIAAgAAAAAAAQACAAIAAgAAAAAAAQD//wIAAgAAAAAAAQD+/wIAAgAAAAAAAQD9/wIAAgAAAAAAAQD8/wIAAgAAAAAAAQD7/wIAAgAAAAAAAQD6/wIAAgAAAAAAAQD5/wIAAgAAAAAAAQADAAAAAgAAAAAAAQAEAAAAAgAAAAAAAQAFAP3/AgAAAAAAAQD4////AgAAAAAAAQA=")
tile_set = ExtResource("5_j0nxd")

[node name="Walls" type="TileMapLayer" parent="."]
use_parent_material = true
tile_map_data = PackedByteArray("AAADAAEABgAAAAAAAgADAAAABgAAAAAAAgAFAP//BgAAAAAAAgAFAP7/BgAAAAAAAgAFAP3/BgAAAAAAAgAGAPz/BgAAAAAAAgAGAPv/BgAAAAAAAgAGAPr/BgAAAAAAAgD4/wEABwAAAAAAAgD4/wAABwAAAAAAAgD4////BwAAAAAAAgD3//7/BwAAAAAAAgD3//3/BwAAAAAAAgD3//z/BwAAAAAAAgD3//v/BwAAAAAAAgD3//r/BwAAAAAAAgA=")
tile_set = ExtResource("5_j0nxd")

[node name="Overlay" type="TileMapLayer" parent="."]
use_parent_material = true
tile_map_data = PackedByteArray("AAD4////AAAFAAEAAAADAAAAAAABAAEAAAAFAP3/AAABAAEAAAADAAEAAAABAAIAAAAFAP//AAABAAIAAAAFAP7/AAABAAMAAAAGAPz/AAABAAMAAAAGAPv/AAABAAIAAAAGAPr/AAABAAIAAAD4/wAAAAAFAAMAAAD4/wEAAAAFAAIAAAD3//7/AAAFAAIAAAD3//3/AAAFAAMAAAD3//z/AAAFAAMAAAD3//v/AAAFAAIAAAD3//r/AAAFAAIAAAAEAAAAAAADAAEAAAACAAIAAAADAAEAAAABAAIAAAACAAEAAAAAAAIAAAADAAEAAAD//wIAAAACAAEAAAD+/wIAAAADAAEAAAD9/wIAAAADAAEAAAD8/wIAAAACAAEAAAD7/wIAAAACAAEAAAD6/wIAAAADAAEAAAD5/wIAAAADAAEAAAADAAIAAAAEAAQAAAD4/wIAAAACAAQAAAD3////AAACAAQAAAAFAAAAAAAEAAQAAAAGAP3/AAAEAAQAAAAGAPn/AAABAAQAAAD3//n/AAAFAAQAAAAGAPj/AAAEAAQAAAD3//j/AAACAAQAAAD3//X/AAACAAQAAAAGAPb/AAAEAAQAAAD4//7/AAACAAAAAAAFAPz/AAACAAAAAAAEAP//AAACAAAAAAACAAEAAAADAAAAAAABAAEAAAADAAAAAAD5/wEAAAADAAAAAAAAAAEAAAACAAAAAAA=")
tile_set = ExtResource("5_j0nxd")

[node name="Camera" parent="." instance=ExtResource("6_5ywwy")]

[node name="Door" parent="." instance=ExtResource("7_4di10")]
position = Vector2(64, 0)

[node name="SceneConnection" parent="Door" index="0"]
node_path = "Door"

[node name="EndScene" parent="." instance=ExtResource("4_epejp")]

[node name="Dialogue" parent="EndScene/DialogueTrigger" index="0" node_paths=PackedStringArray("collision", "custom_writer_target")]
collision = NodePath("../Area2D/CollisionShape2D")
custom_writer_target = NodePath("../../../AnimatedSprite2D/Writer")

[node name="Interact" type="Node" parent="EndScene/DialogueTrigger" index="1" node_paths=PackedStringArray("area", "dialogue")]
script = ExtResource("8_13h1s")
area = NodePath("../Area2D")
dialogue = NodePath("../Dialogue")

[node name="Area2D" parent="EndScene/DialogueTrigger" index="2"]
collision_mask = 4

[node name="CollisionShape2D" parent="EndScene/DialogueTrigger/Area2D" index="0"]
position = Vector2(-66, 22)

[node name="AnimatedSprite2D" type="AnimatedSprite2D" parent="."]
use_parent_material = true
position = Vector2(-80, 16)
sprite_frames = SubResource("SpriteFrames_kh50a")
animation = &"idle"
autoplay = "idle"

[node name="Writer" type="Control" parent="AnimatedSprite2D" node_paths=PackedStringArray("dialogue_label", "continue_texture", "speak_sfx")]
use_parent_material = true
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = -16.0
offset_top = -28.0
offset_right = -16.0
offset_bottom = -28.0
grow_horizontal = 2
grow_vertical = 2
script = ExtResource("9_rdfn1")
base_write_time = 0.05
dialogue_label = NodePath("Label")
continue_texture = NodePath("Label/NinePatchRect/TextureRect")
speak_sfx = NodePath("Audio/Speak")

[node name="Label" type="Label" parent="AnimatedSprite2D/Writer"]
use_parent_material = true
layout_mode = 1
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -0.5
offset_top = -4.0
offset_right = 0.5
offset_bottom = 4.0
grow_horizontal = 2
grow_vertical = 2
size_flags_horizontal = 2
theme_override_fonts/font = ExtResource("10_ywiws")
theme_override_font_sizes/font_size = 8
text = "Text"
vertical_alignment = 1

[node name="NinePatchRect" type="NinePatchRect" parent="AnimatedSprite2D/Writer/Label"]
show_behind_parent = true
use_parent_material = true
layout_mode = 1
anchors_preset = -1
anchor_right = 1.0
offset_left = -2.0
offset_top = -2.0
offset_right = 1.0
offset_bottom = 10.0
grow_horizontal = 2
grow_vertical = 2
texture = ExtResource("11_s0apf")
region_rect = Rect2(0, 0, 16, 16)
patch_margin_left = 1
patch_margin_top = 1
patch_margin_right = 1
patch_margin_bottom = 1
axis_stretch_horizontal = 1
axis_stretch_vertical = 1

[node name="TextureRect" type="TextureRect" parent="AnimatedSprite2D/Writer/Label/NinePatchRect"]
use_parent_material = true
layout_mode = 1
anchors_preset = 3
anchor_left = 1.0
anchor_top = 1.0
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = -5.0
offset_top = -4.0
offset_right = 5.0
offset_bottom = 6.0
grow_horizontal = 0
grow_vertical = 0
texture = SubResource("AtlasTexture_eyybe")
stretch_mode = 2

[node name="Audio" type="Node" parent="AnimatedSprite2D/Writer"]

[node name="Speak" parent="AnimatedSprite2D/Writer/Audio" instance=ExtResource("14_yfxiy")]

[connection signal="body_entered" from="EndScene/DialogueTrigger/Area2D" to="EndScene/DialogueTrigger/Interact" method="_on_body_entered"]
[connection signal="body_exited" from="EndScene/DialogueTrigger/Area2D" to="EndScene/DialogueTrigger/Interact" method="_on_body_exited"]

[editable path="Door"]
[editable path="EndScene"]
[editable path="EndScene/DialogueTrigger"]
[editable path="EndScene/Camera"]
